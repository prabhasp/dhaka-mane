Derived from work by [https://gist.github.com/mbostock/949c772b81296f8e4188](@mbostock)
